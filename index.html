<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no, maximum-scale=1.0, minimum-scale=1.0">
    <link href="https://fonts.googleapis.com/css2?family=Oswald:wght@400;500;600&display=swap" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Helvetica+Neue:wght@400;500;600&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <link rel="stylesheet" href="scroll.css">
    <title>Ekbal School</title>
    <style>
    /* Reset CSS */
    * {
        margin: 0;
        padding: 0;
        box-sizing: border-box;
        font-family: Oswald;
    }

    /* Custom Fonts */
  
    :root {
        --primary-color: #003470;
        --secondary-color: #3498db;
        --accent-color: #e74c3c;
        --light-color: #fff;
        --dark-color: #003470;
        --fb-blue: #1877f2;
        --fb-grey: #f0f2f5;
        --fb-dark: #1c1e21;
        --fb-white: #ffffff;
        font-family: 'Oswald', sans-serif;
    }

    body {
        font-family: 'Oswald', sans-serif;
        line-height: 1.6;
        overflow-x: hidden;
        background-color: var(--fb-grey);
        padding-top: 80px; /* Add padding to account for fixed navbar */
    }

    .navbar {
        padding: 1.6rem 5%;
        position: fixed;
        width: 100%;
        z-index: 1000;
        transition: 0.3s;
        background: var(--primary-color);
        font-family: 'Oswald', sans-serif;
        top: 0; /* Fix navbar to top */
    }

    .nav-content {
        display: flex;
        justify-content: space-between;
        align-items: center;
        position: relative;
        font-family: 'Oswald', sans-serif;
    }

    .logo {
        color: var(--light-color);
        font-size: 2rem;
        font-weight: 700;
        text-decoration: none;
        -webkit-tap-highlight-color: transparent;
        outline: none;
        font-family: 'Oswald', sans-serif;
        letter-spacing: 2px;
        font-size: 0;
        font-family: 'Oswald', sans-serif;
    }

    .logo-container {
        display: flex;
        flex-direction: column;
        align-items: flex-start;
        order: 2;
        font-family: 'Oswald', sans-serif;
    }

    .department-text {
        color: #808080;
        font-size: 0.8rem;
        margin-top: -5px;
        margin-left: 0px;
        display: none;
        font-family: 'Oswald', sans-serif;
    }

    .nav-links {
        display: flex;
        gap: 2rem;
        margin-right: 3rem;
        order: 1;
        font-family: 'Oswald', sans-serif;
    }

    .nav-links a {
        color: var(--light-color);
        text-decoration: none;
        font-weight: 500;
        font-family: Oswald;
    }

    .menu-btn {
        display: none;
        color: var(--light-color);
        font-size: 1.5rem;
        cursor: pointer;
        background: none;
        border: none;
        padding: 0.5rem;
        outline: none;
        -webkit-tap-highlight-color: transparent;
    }

    .menu-btn .bar {
        display: block;
        width: 25px;
        height: 3px;
        margin: 5px auto;
        background-color: var(--light-color);
        transition: 0.3s;
    }

    .mobile-menu {
        position: absolute;
        top: 100%;
        left: 0;
        width: 100%;
        background: var(--primary-color);
        padding: 0;
        max-height: 0;
        overflow: hidden;
        transition: max-height 0.3s ease-in-out, padding 0.3s ease-in-out;
        text-align: center;
        display: flex;
        flex-direction: column;
    }

    .mobile-menu.active {
        max-height: 300px;
        padding: 1rem 0;
    }

    .mobile-menu a {
        display: block;
        color: var(--light-color);
        text-decoration: none;
        padding: 0.5rem 5%;
        font-weight: 500;
        font-family: 'Poppins', sans-serif;
    }

    .menu-btn.active .bar:nth-child(1) {
        transform: rotate(-45deg) translate(-5px, 6px);
    }

    .menu-btn.active .bar:nth-child(2) {
        opacity: 0;
    }

    .menu-btn.active .bar:nth-child(3) {
        transform: rotate(45deg) translate(-5px, -6px);
    }

    .home-icon, .teacher-icon {
        display: none;
        color: var(--light-color);
        font-size: 1.5rem;
        text-decoration: none;
        outline: none;
        -webkit-tap-highlight-color: transparent;
    }

    .teacher-icon {
        display: block;
        margin-left: auto;
        padding-right: 0;
    }

    .right-icons {
        order: 3;
        display: flex;
        align-items: center;
        gap: 2.5rem;
    }

    #gallery {
        max-width: 680px;
        margin: 20px auto;
        padding: 20px;
    }

    .post {
        background: var(--fb-white);
        border-radius: 8px;
        margin-bottom: 20px;
        box-shadow: 0 1px 2px rgba(0, 0, 0, 0.1);
        overflow: hidden;
    }

    .post-header {
        padding: 12px 16px;
        display: flex;
        align-items: center;
    }

    .post-avatar {
        width: 40px;
        height: 40px;
        border-radius: 50%;
        background-image: url('https://i.imgur.com/1aYDbH1.png');
        background-size: cover;
        margin-right: 12px;
    }

    .post-info {
        flex: 1;
    }

    .post-username {
        font-weight: 600;
        color: var(--fb-dark);
        margin-bottom: 4px;
    }

    .post-time {
        font-size: 12px;
        color: #65676b;
    }

    .post-images {
        display: grid;
        gap: 2px;
    }

    /* Grid layouts based on image count */
    .post-images.single {
        grid-template-columns: 1fr;
    }

    .post-images.double {
        grid-template-columns: 1fr 1fr;
    }

    .post-images.triple {
        grid-template-columns: 1fr 1fr;
    }

    .post-images.triple img:first-child {
        grid-column: 1 / -1;
    }

    .post-images.quad {
        grid-template-columns: 1fr 1fr;
    }

    .post-images.many {
        grid-template-columns: 1fr 1fr 1fr;
    }

    .post-images img {
        width: 100%;
        aspect-ratio: 1;
        object-fit: cover;
        display: block;
        cursor: pointer;
    }

    /* Fullscreen overlay */
    .fullscreen-overlay {
        display: none;
        position: fixed;
        top: 80px; /* Below navbar */
        left: 0;
        right: 0;
        bottom: 0;
        background: rgba(0, 0, 0, 0.9);
        z-index: 999;
        touch-action: none;
    }

    .fullscreen-overlay.active {
        display: flex;
        justify-content: center;
        align-items: center;
    }

    .fullscreen-image {
        max-width: 100%;
        max-height: calc(100vh - 80px);
        object-fit: contain;
        transition: transform 0.3s ease-out;
    }

    .fullscreen-image.slide-left {
        transform: translateX(-100%);
    }

    .fullscreen-image.slide-right {
        transform: translateX(100%);
    }

    .fullscreen-image.slide-reset {
        transform: translateX(0);
    }

    .close-btn {
        position: absolute;
        top: 20px;
        right: 20px;
        color: white;
        font-size: 30px;
        cursor: pointer;
        z-index: 1001;
    }

    .nav-arrows {
        position: absolute;
        top: 50%;
        width: 100%;
        display: flex;
        justify-content: space-between;
        padding: 0 20px;
        transform: translateY(-50%);
        z-index: 1001;
    }

    .nav-arrow {
        color: white;
        font-size: 30px;
        cursor: pointer;
        padding: 10px;
    }

    @media (max-width: 768px) {
        .navbar {
            padding: 0.7rem 5%;
        }
        
        .nav-links {
            display: none;
        }
        
        .menu-btn {
            display: block;
            order: 3;
            transform: translateY(3.5px);
        }

        .home-icon {
            display: block;
            order: 2;
        }

        .teacher-icon {
            order: 1;
            margin-left: 0;
            transform: translateY(3px);
        }

        .logo {
            display: block;
            font-size: 1.8rem;
            letter-spacing: 6px;
        }

        .department-text {
            display: block;
            letter-spacing: 4px;
        }

        .logo-container {
            order: unset;
        }

        .nav-links {
            order: unset;
        }

        .right-icons {
            order: unset;
            gap: 1.2rem;
            margin-right: 10px;
        }

        #gallery {
            padding: 10px;
        }

        .nav-arrows {
            display: none; /* Hide arrows on mobile */
        }

        .fullscreen-overlay {
            background: #000; /* Solid black background on mobile */
        }
    }
</style>
</head>
<body>
    <nav class="navbar">
        <div class="nav-content">
            <div class="nav-links">
                <a href="https://ekbal.site/">Home</a> <span style="color: #d3d3d3;">/</span>
                <a href="https://ekbal.site/monthly_marks.html">Monthly marks</a> <span style="color: #d3d3d3;">/</span>
                <a href="https://ekbal.site/timetable.html">Timetables</a> <span style="color: #d3d3d3;">/</span>
                <a href="https://ekbal.site/Groups.html">Groups</a> <span style="color: #d3d3d3;">/</span>
                <a href="https://ekbal.site/awards.html">Award</a> <span style="color: #d3d3d3;">/</span>
                <a href="https://ekbal.site/about.html">About</a>
            </div>
            <div class="logo-container">
                <a href="https://ekbal.site/" class="logo">EL EKBAL</a>
                <span class="department-text">BOYS DEPARTMENT</span>
            </div>
            <div class="right-icons">
                <a href="https://ekbal.site/" class="home-icon">
                    <i class="fas fa-home"></i>
                </a>
                <a href="https://ekbal.site/teachers.html" class="teacher-icon fas fa-chalkboard-teacher"></a>
                <button class="menu-btn">
                    <span class="bar"></span>
                    <span class="bar"></span>
                    <span class="bar"></span>
                </button>
            </div>
        </div>
        <div class="mobile-menu">
            <a href="https://ekbal.site/monthly_marks.html">Monthly marks</a>
            <a href="https://ekbal.site/timetable.html">Timetables</a>
            <a href="https://ekbal.site/Groups.html">Groups</a>
            <a href="https://ekbal.site/awards.html">Award</a>
            <a href="https://ekbal.site/about.html">About</a>
        </div>
    </nav>

    <div id="gallery"></div>
    <div class="fullscreen-overlay">
        <div class="close-btn"><i class="fas fa-times"></i></div>
        <div class="nav-arrows">
            <div class="nav-arrow prev"><i class="fas fa-chevron-left"></i></div>
            <div class="nav-arrow next"><i class="fas fa-chevron-right"></i></div>
        </div>
        <img class="fullscreen-image" src="" alt="">
    </div>
    <script>
        const menuBtn = document.querySelector('.menu-btn');
const mobileMenu = document.querySelector('.mobile-menu');

menuBtn.addEventListener('click', () => {
    menuBtn.classList.toggle('active');
    mobileMenu.classList.toggle('active');
});

function getRelativeTime(date) {
    const now = new Date();
    const diff = now - date;
    
    const minutes = Math.floor(diff / 60000);
    const hours = Math.floor(diff / 3600000);
    const days = Math.floor(diff / 86400000);

    if (minutes < 1) {
        return 'Just now';
    } else if (minutes < 60) {
        return `${minutes} ${minutes === 1 ? 'minute' : 'minutes'} ago`;
    } else if (hours < 24) {
        return `${hours} ${hours === 1 ? 'hour' : 'hours'} ago`;
    } else if (days === 1) {
        return 'Yesterday';
    } else if (days < 7) {
        return `${days} days ago`;
    } else {
        return date.toLocaleDateString('en-US', { 
            year: 'numeric', 
            month: 'short', 
            day: 'numeric' 
        });
    }
}

async function fetchImages() {
    const apiUrl = 'https://api.github.com/repos/A7mdmohamed04/private/contents/images';
    
    try {
        const response = await fetch(apiUrl);
        const files = await response.json();
        const gallery = document.getElementById('gallery');
        
        // Get file metadata to sort by upload date
        const filePromises = files.map(async file => {
            const commitResponse = await fetch(`https://api.github.com/repos/A7mdmohamed04/private/commits?path=images/${file.name}&page=1&per_page=1`);
            const commits = await commitResponse.json();
            return {
                ...file,
                uploadDate: new Date(commits[0].commit.author.date)
            };
        });

        const filesWithDates = await Promise.all(filePromises);
        
        // Sort files by upload date, newest first
        const sortedFiles = filesWithDates.sort((a, b) => b.uploadDate - a.uploadDate);
        
        // Group files by upload time (rounded to nearest minute)
        const groupedFiles = {};
        sortedFiles.forEach(file => {
            if (file.type === 'file' && /\.(jpg|jpeg|png|gif)$/i.test(file.name)) {
                // Round to nearest minute to group files uploaded close together
                const date = new Date(file.uploadDate);
                date.setSeconds(0, 0);
                const timeKey = date.getTime();
                
                if (!groupedFiles[timeKey]) {
                    groupedFiles[timeKey] = {
                        date: file.uploadDate,
                        files: []
                    };
                }
                groupedFiles[timeKey].files.push(file);
            }
        });

        // Create posts for each group
        Object.values(groupedFiles).forEach(group => {
            const post = document.createElement('div');
            post.className = 'post';
            
            const postHeader = document.createElement('div');
            postHeader.className = 'post-header';
            
            const avatar = document.createElement('div');
            avatar.className = 'post-avatar';
            
            const postInfo = document.createElement('div');
            postInfo.className = 'post-info';
            
            const username = document.createElement('div');
            username.className = 'post-username';
            username.textContent = 'El Ekbal School';
            
            const time = document.createElement('div');
            time.className = 'post-time';
            time.textContent = getRelativeTime(group.date);
            
            postInfo.appendChild(username);
            postInfo.appendChild(time);
            
            postHeader.appendChild(avatar);
            postHeader.appendChild(postInfo);
            
            const imagesContainer = document.createElement('div');
            imagesContainer.className = 'post-images';
            
            // Add layout class based on number of images
            const imageCount = group.files.length;
            if (imageCount === 1) {
                imagesContainer.classList.add('single');
            } else if (imageCount === 2) {
                imagesContainer.classList.add('double');
            } else if (imageCount === 3) {
                imagesContainer.classList.add('triple');
            } else if (imageCount === 4) {
                imagesContainer.classList.add('quad');
            } else {
                imagesContainer.classList.add('many');
            }

            // Store the group's images for fullscreen navigation
            const groupImages = [];
            
            group.files.forEach(file => {
                const img = document.createElement('img');
                img.src = file.download_url;
                img.alt = file.name;
                groupImages.push(file.download_url);
                
                img.addEventListener('click', () => {
                    openFullscreen(groupImages, groupImages.indexOf(file.download_url));
                });
                
                imagesContainer.appendChild(img);
            });
            
            post.appendChild(postHeader);
            post.appendChild(imagesContainer);
            gallery.appendChild(post);
        });
    } catch (error) {
        console.error('Error fetching images:', error);
    }
}

// Fullscreen functionality
const overlay = document.querySelector('.fullscreen-overlay');
const fullscreenImg = document.querySelector('.fullscreen-image');
const closeBtn = document.querySelector('.close-btn');
const prevBtn = document.querySelector('.nav-arrow.prev');
const nextBtn = document.querySelector('.nav-arrow.next');

let currentImages = [];
let currentIndex = 0;
let startY = 0;
let currentY = 0;

function openFullscreen(images, index) {
    currentImages = images;
    currentIndex = index;
    showCurrentImage();
    overlay.classList.add('active');
    document.body.style.overflow = 'hidden';
}

function showCurrentImage() {
    fullscreenImg.src = currentImages[currentIndex];
    updateArrowVisibility();
}

function updateArrowVisibility() {
    // Only show arrows on desktop
    if (window.innerWidth > 768) {
        prevBtn.style.display = currentIndex > 0 ? 'block' : 'none';
        nextBtn.style.display = currentIndex < currentImages.length - 1 ? 'block' : 'none';
    } else {
        prevBtn.style.display = 'none';
        nextBtn.style.display = 'none';
    }
}

function closeFullscreen() {
    overlay.classList.remove('active');
    document.body.style.overflow = '';
}

closeBtn.addEventListener('click', closeFullscreen);

function navigateImage(direction) {
    const newIndex = currentIndex + direction;
    if (newIndex >= 0 && newIndex < currentImages.length) {
        // Add animation class based on direction
        fullscreenImg.classList.add(direction > 0 ? 'slide-left' : 'slide-right');
        
        // After animation completes, update image and reset animation
        setTimeout(() => {
            currentIndex = newIndex;
            showCurrentImage();
            fullscreenImg.classList.remove('slide-left', 'slide-right');
            fullscreenImg.classList.add('slide-reset');
            
            // Remove reset class after transition
            setTimeout(() => {
                fullscreenImg.classList.remove('slide-reset');
            }, 300);
        }, 300);
    }
}

prevBtn.addEventListener('click', () => navigateImage(-1));
nextBtn.addEventListener('click', () => navigateImage(1));

// Touch events for swipe navigation
overlay.addEventListener('touchstart', (e) => {
    startY = e.touches[0].clientY;
    currentY = startY;
});

overlay.addEventListener('touchmove', (e) => {
    currentY = e.touches[0].clientY;
    const diff = currentY - startY;
    
    if (diff > 100) {
        closeFullscreen();
    }
});

// Swipe left/right for navigation
let touchStartX = 0;
overlay.addEventListener('touchstart', (e) => {
    touchStartX = e.touches[0].clientX;
});

overlay.addEventListener('touchend', (e) => {
    const touchEndX = e.changedTouches[0].clientX;
    const diff = touchEndX - touchStartX;
    
    if (Math.abs(diff) > 50) { // Minimum swipe distance
        if (diff > 0 && currentIndex > 0) {
            // Swipe right - previous image
            navigateImage(-1);
        } else if (diff < 0 && currentIndex < currentImages.length - 1) {
            // Swipe left - next image
            navigateImage(1);
        }
    }
});

fetchImages();

    </script>
    
</body>
</html>
